{"ast":null,"code":"import { addEventListener, instrumentMethodAndCallOriginal, Observable, shallowClone } from '@datadog/browser-core';\nexport function createLocationChangeObservable(location) {\n  var currentLocation = shallowClone(location);\n  var observable = new Observable(function () {\n    var stopHistoryTracking = trackHistory(onLocationChange).stop;\n    var stopHashTracking = trackHash(onLocationChange).stop;\n    return function () {\n      stopHistoryTracking();\n      stopHashTracking();\n    };\n  });\n  function onLocationChange() {\n    if (currentLocation.href === location.href) {\n      return;\n    }\n    var newLocation = shallowClone(location);\n    observable.notify({\n      newLocation: newLocation,\n      oldLocation: currentLocation\n    });\n    currentLocation = newLocation;\n  }\n  return observable;\n}\nfunction trackHistory(onHistoryChange) {\n  var stopInstrumentingPushState = instrumentMethodAndCallOriginal(history, 'pushState', {\n    after: onHistoryChange\n  }).stop;\n  var stopInstrumentingReplaceState = instrumentMethodAndCallOriginal(history, 'replaceState', {\n    after: onHistoryChange\n  }).stop;\n  var removeListener = addEventListener(window, \"popstate\" /* POP_STATE */, onHistoryChange).stop;\n  return {\n    stop: function () {\n      stopInstrumentingPushState();\n      stopInstrumentingReplaceState();\n      removeListener();\n    }\n  };\n}\nfunction trackHash(onHashChange) {\n  return addEventListener(window, \"hashchange\" /* HASH_CHANGE */, onHashChange);\n}","map":{"version":3,"names":["addEventListener","instrumentMethodAndCallOriginal","Observable","shallowClone","createLocationChangeObservable","location","currentLocation","observable","stopHistoryTracking","trackHistory","onLocationChange","stop","stopHashTracking","trackHash","href","newLocation","notify","oldLocation","onHistoryChange","stopInstrumentingPushState","history","after","stopInstrumentingReplaceState","removeListener","window","onHashChange"],"sources":["/Users/sean.dever/Desktop/PersonalRepos/apm-enablement-sessions/rum_and_trace_correlation/rum_app/node_modules/@datadog/browser-rum-core/src/browser/locationChangeObservable.ts"],"sourcesContent":["import {\n  addEventListener,\n  DOM_EVENT,\n  instrumentMethodAndCallOriginal,\n  Observable,\n  shallowClone,\n} from '@datadog/browser-core'\n\nexport interface LocationChange {\n  oldLocation: Readonly<Location>\n  newLocation: Readonly<Location>\n}\n\nexport function createLocationChangeObservable(location: Location) {\n  let currentLocation = shallowClone(location)\n  const observable = new Observable<LocationChange>(() => {\n    const { stop: stopHistoryTracking } = trackHistory(onLocationChange)\n    const { stop: stopHashTracking } = trackHash(onLocationChange)\n    return () => {\n      stopHistoryTracking()\n      stopHashTracking()\n    }\n  })\n\n  function onLocationChange() {\n    if (currentLocation.href === location.href) {\n      return\n    }\n    const newLocation = shallowClone(location)\n    observable.notify({\n      newLocation,\n      oldLocation: currentLocation,\n    })\n    currentLocation = newLocation\n  }\n\n  return observable\n}\n\nfunction trackHistory(onHistoryChange: () => void) {\n  const { stop: stopInstrumentingPushState } = instrumentMethodAndCallOriginal(history, 'pushState', {\n    after: onHistoryChange,\n  })\n  const { stop: stopInstrumentingReplaceState } = instrumentMethodAndCallOriginal(history, 'replaceState', {\n    after: onHistoryChange,\n  })\n  const { stop: removeListener } = addEventListener(window, DOM_EVENT.POP_STATE, onHistoryChange)\n\n  return {\n    stop: () => {\n      stopInstrumentingPushState()\n      stopInstrumentingReplaceState()\n      removeListener()\n    },\n  }\n}\n\nfunction trackHash(onHashChange: () => void) {\n  return addEventListener(window, DOM_EVENT.HASH_CHANGE, onHashChange)\n}\n"],"mappings":"AAAA,SACEA,gBAAgB,EAEhBC,+BAA+B,EAC/BC,UAAU,EACVC,YAAY,QACP,uBAAuB;AAO9B,OAAM,SAAUC,8BAA8BA,CAACC,QAAkB;EAC/D,IAAIC,eAAe,GAAGH,YAAY,CAACE,QAAQ,CAAC;EAC5C,IAAME,UAAU,GAAG,IAAIL,UAAU,CAAiB;IACxC,IAAMM,mBAAmB,GAAKC,YAAY,CAACC,gBAAgB,CAAC,CAAAC,IAAnC;IACzB,IAAMC,gBAAgB,GAAKC,SAAS,CAACH,gBAAgB,CAAC,CAAAC,IAAhC;IAC9B,OAAO;MACLH,mBAAmB,EAAE;MACrBI,gBAAgB,EAAE;IACpB,CAAC;EACH,CAAC,CAAC;EAEF,SAASF,gBAAgBA,CAAA;IACvB,IAAIJ,eAAe,CAACQ,IAAI,KAAKT,QAAQ,CAACS,IAAI,EAAE;MAC1C;;IAEF,IAAMC,WAAW,GAAGZ,YAAY,CAACE,QAAQ,CAAC;IAC1CE,UAAU,CAACS,MAAM,CAAC;MAChBD,WAAW,EAAAA,WAAA;MACXE,WAAW,EAAEX;KACd,CAAC;IACFA,eAAe,GAAGS,WAAW;EAC/B;EAEA,OAAOR,UAAU;AACnB;AAEA,SAASE,YAAYA,CAACS,eAA2B;EACvC,IAAMC,0BAA0B,GAAKlB,+BAA+B,CAACmB,OAAO,EAAE,WAAW,EAAE;IACjGC,KAAK,EAAEH;GACR,CAAC,CAAAP,IAFsC;EAGhC,IAAMW,6BAA6B,GAAKrB,+BAA+B,CAACmB,OAAO,EAAE,cAAc,EAAE;IACvGC,KAAK,EAAEH;GACR,CAAC,CAAAP,IAFyC;EAGnC,IAAMY,cAAc,GAAKvB,gBAAgB,CAACwB,MAAM,8BAAuBN,eAAe,CAAC,CAAAP,IAAnE;EAE5B,OAAO;IACLA,IAAI,EAAE,SAAAA,CAAA;MACJQ,0BAA0B,EAAE;MAC5BG,6BAA6B,EAAE;MAC/BC,cAAc,EAAE;IAClB;GACD;AACH;AAEA,SAASV,SAASA,CAACY,YAAwB;EACzC,OAAOzB,gBAAgB,CAACwB,MAAM,kCAAyBC,YAAY,CAAC;AACtE"},"metadata":{},"sourceType":"module","externalDependencies":[]}