{"ast":null,"code":"import { assign, objectValues } from '../../tools/utils';\nimport { createEndpointBuilder } from './endpointBuilder';\nimport { buildTags } from './tags';\nimport { INTAKE_SITE_US1 } from './intakeSites';\nexport function computeTransportConfiguration(initConfiguration) {\n  var tags = buildTags(initConfiguration);\n  var endpointBuilders = computeEndpointBuilders(initConfiguration, tags);\n  var intakeUrlPrefixes = objectValues(endpointBuilders).map(function (builder) {\n    return builder.urlPrefix;\n  });\n  var replicaConfiguration = computeReplicaConfiguration(initConfiguration, intakeUrlPrefixes, tags);\n  return assign({\n    isIntakeUrl: function (url) {\n      return intakeUrlPrefixes.some(function (intakeEndpoint) {\n        return url.indexOf(intakeEndpoint) === 0;\n      });\n    },\n    replica: replicaConfiguration,\n    site: initConfiguration.site || INTAKE_SITE_US1\n  }, endpointBuilders);\n}\nfunction computeEndpointBuilders(initConfiguration, tags) {\n  return {\n    logsEndpointBuilder: createEndpointBuilder(initConfiguration, 'logs', tags),\n    rumEndpointBuilder: createEndpointBuilder(initConfiguration, 'rum', tags),\n    sessionReplayEndpointBuilder: createEndpointBuilder(initConfiguration, 'sessionReplay', tags)\n  };\n}\nfunction computeReplicaConfiguration(initConfiguration, intakeUrlPrefixes, tags) {\n  if (!initConfiguration.replica) {\n    return;\n  }\n  var replicaConfiguration = assign({}, initConfiguration, {\n    site: INTAKE_SITE_US1,\n    clientToken: initConfiguration.replica.clientToken\n  });\n  var replicaEndpointBuilders = {\n    logsEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'logs', tags),\n    rumEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'rum', tags)\n  };\n  intakeUrlPrefixes.push.apply(intakeUrlPrefixes, objectValues(replicaEndpointBuilders).map(function (builder) {\n    return builder.urlPrefix;\n  }));\n  return assign({\n    applicationId: initConfiguration.replica.applicationId\n  }, replicaEndpointBuilders);\n}","map":{"version":3,"names":["assign","objectValues","createEndpointBuilder","buildTags","INTAKE_SITE_US1","computeTransportConfiguration","initConfiguration","tags","endpointBuilders","computeEndpointBuilders","intakeUrlPrefixes","map","builder","urlPrefix","replicaConfiguration","computeReplicaConfiguration","isIntakeUrl","url","some","intakeEndpoint","indexOf","replica","site","logsEndpointBuilder","rumEndpointBuilder","sessionReplayEndpointBuilder","clientToken","replicaEndpointBuilders","push","apply","applicationId"],"sources":["/Users/sean.dever/Desktop/PersonalRepos/react-app/node_modules/@datadog/browser-core/src/domain/configuration/transportConfiguration.ts"],"sourcesContent":["import { assign, objectValues } from '../../tools/utils'\nimport type { InitConfiguration } from './configuration'\nimport type { EndpointBuilder } from './endpointBuilder'\nimport { createEndpointBuilder } from './endpointBuilder'\nimport { buildTags } from './tags'\nimport { INTAKE_SITE_US1 } from './intakeSites'\n\nexport interface TransportConfiguration {\n  logsEndpointBuilder: EndpointBuilder\n  rumEndpointBuilder: EndpointBuilder\n  sessionReplayEndpointBuilder: EndpointBuilder\n  isIntakeUrl: (url: string) => boolean\n  replica?: ReplicaConfiguration\n  site: string\n}\n\nexport interface ReplicaConfiguration {\n  applicationId?: string\n  logsEndpointBuilder: EndpointBuilder\n  rumEndpointBuilder: EndpointBuilder\n}\n\nexport function computeTransportConfiguration(initConfiguration: InitConfiguration): TransportConfiguration {\n  const tags = buildTags(initConfiguration)\n\n  const endpointBuilders = computeEndpointBuilders(initConfiguration, tags)\n  const intakeUrlPrefixes = objectValues(endpointBuilders).map((builder) => builder.urlPrefix)\n\n  const replicaConfiguration = computeReplicaConfiguration(initConfiguration, intakeUrlPrefixes, tags)\n\n  return assign(\n    {\n      isIntakeUrl: (url: string) => intakeUrlPrefixes.some((intakeEndpoint) => url.indexOf(intakeEndpoint) === 0),\n      replica: replicaConfiguration,\n      site: initConfiguration.site || INTAKE_SITE_US1,\n    },\n    endpointBuilders\n  )\n}\n\nfunction computeEndpointBuilders(initConfiguration: InitConfiguration, tags: string[]) {\n  return {\n    logsEndpointBuilder: createEndpointBuilder(initConfiguration, 'logs', tags),\n    rumEndpointBuilder: createEndpointBuilder(initConfiguration, 'rum', tags),\n    sessionReplayEndpointBuilder: createEndpointBuilder(initConfiguration, 'sessionReplay', tags),\n  }\n}\n\nfunction computeReplicaConfiguration(\n  initConfiguration: InitConfiguration,\n  intakeUrlPrefixes: string[],\n  tags: string[]\n): ReplicaConfiguration | undefined {\n  if (!initConfiguration.replica) {\n    return\n  }\n\n  const replicaConfiguration: InitConfiguration = assign({}, initConfiguration, {\n    site: INTAKE_SITE_US1,\n    clientToken: initConfiguration.replica.clientToken,\n  })\n\n  const replicaEndpointBuilders = {\n    logsEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'logs', tags),\n    rumEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'rum', tags),\n  }\n\n  intakeUrlPrefixes.push(...objectValues(replicaEndpointBuilders).map((builder) => builder.urlPrefix))\n\n  return assign({ applicationId: initConfiguration.replica.applicationId }, replicaEndpointBuilders)\n}\n"],"mappings":"AAAA,SAASA,MAAM,EAAEC,YAAY,QAAQ,mBAAmB;AAGxD,SAASC,qBAAqB,QAAQ,mBAAmB;AACzD,SAASC,SAAS,QAAQ,QAAQ;AAClC,SAASC,eAAe,QAAQ,eAAe;AAiB/C,OAAM,SAAUC,6BAA6BA,CAACC,iBAAoC;EAChF,IAAMC,IAAI,GAAGJ,SAAS,CAACG,iBAAiB,CAAC;EAEzC,IAAME,gBAAgB,GAAGC,uBAAuB,CAACH,iBAAiB,EAAEC,IAAI,CAAC;EACzE,IAAMG,iBAAiB,GAAGT,YAAY,CAACO,gBAAgB,CAAC,CAACG,GAAG,CAAC,UAACC,OAAO;IAAK,OAAAA,OAAO,CAACC,SAAS;EAAjB,CAAiB,CAAC;EAE5F,IAAMC,oBAAoB,GAAGC,2BAA2B,CAACT,iBAAiB,EAAEI,iBAAiB,EAAEH,IAAI,CAAC;EAEpG,OAAOP,MAAM,CACX;IACEgB,WAAW,EAAE,SAAAA,CAACC,GAAW;MAAK,OAAAP,iBAAiB,CAACQ,IAAI,CAAC,UAACC,cAAc;QAAK,OAAAF,GAAG,CAACG,OAAO,CAACD,cAAc,CAAC,KAAK,CAAC;MAAjC,CAAiC,CAAC;IAA7E,CAA6E;IAC3GE,OAAO,EAAEP,oBAAoB;IAC7BQ,IAAI,EAAEhB,iBAAiB,CAACgB,IAAI,IAAIlB;GACjC,EACDI,gBAAgB,CACjB;AACH;AAEA,SAASC,uBAAuBA,CAACH,iBAAoC,EAAEC,IAAc;EACnF,OAAO;IACLgB,mBAAmB,EAAErB,qBAAqB,CAACI,iBAAiB,EAAE,MAAM,EAAEC,IAAI,CAAC;IAC3EiB,kBAAkB,EAAEtB,qBAAqB,CAACI,iBAAiB,EAAE,KAAK,EAAEC,IAAI,CAAC;IACzEkB,4BAA4B,EAAEvB,qBAAqB,CAACI,iBAAiB,EAAE,eAAe,EAAEC,IAAI;GAC7F;AACH;AAEA,SAASQ,2BAA2BA,CAClCT,iBAAoC,EACpCI,iBAA2B,EAC3BH,IAAc;EAEd,IAAI,CAACD,iBAAiB,CAACe,OAAO,EAAE;IAC9B;;EAGF,IAAMP,oBAAoB,GAAsBd,MAAM,CAAC,EAAE,EAAEM,iBAAiB,EAAE;IAC5EgB,IAAI,EAAElB,eAAe;IACrBsB,WAAW,EAAEpB,iBAAiB,CAACe,OAAO,CAACK;GACxC,CAAC;EAEF,IAAMC,uBAAuB,GAAG;IAC9BJ,mBAAmB,EAAErB,qBAAqB,CAACY,oBAAoB,EAAE,MAAM,EAAEP,IAAI,CAAC;IAC9EiB,kBAAkB,EAAEtB,qBAAqB,CAACY,oBAAoB,EAAE,KAAK,EAAEP,IAAI;GAC5E;EAEDG,iBAAiB,CAACkB,IAAI,CAAAC,KAAA,CAAtBnB,iBAAiB,EAAST,YAAY,CAAC0B,uBAAuB,CAAC,CAAChB,GAAG,CAAC,UAACC,OAAO;IAAK,OAAAA,OAAO,CAACC,SAAS;EAAjB,CAAiB,CAAC;EAEnG,OAAOb,MAAM,CAAC;IAAE8B,aAAa,EAAExB,iBAAiB,CAACe,OAAO,CAACS;EAAa,CAAE,EAAEH,uBAAuB,CAAC;AACpG"},"metadata":{},"sourceType":"module","externalDependencies":[]}